<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NPS</title>

  <!-- iOS standalone -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f5f5f7;
      margin: 0;
      padding: 24px;
      color: #111;
    }
    h2 {
      margin-bottom: 16px;
    }
    .screen {
      display: none;
    }
    .screen.active {
      display: block;
    }
    button {
      width: 100%;
      padding: 16px;
      margin-bottom: 12px;
      font-size: 18px;
      border-radius: 12px;
      border: 1px solid #ddd;
      background: #fff;
    }
    textarea {
      width: 100%;
      height: 120px;
      font-size: 16px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #ddd;
      resize: none;
    }
  </style>
</head>

<body>

<!-- STEP 1 -->
<div id="step1" class="screen active">
  <h2>–ö—Ç–æ –≤–∞–º –ø–æ–º–æ–≥–∞–ª?</h2>
  <button onclick="selectEmployee('–ê–Ω–Ω–∞')">–ê–Ω–Ω–∞</button>
  <button onclick="selectEmployee('–ò–≤–∞–Ω')">–ò–≤–∞–Ω</button>
  <button onclick="selectEmployee('–ú–∞—Ä–∏—è')">–ú–∞—Ä–∏—è</button>
</div>

<!-- STEP 2 -->
<div id="step2" class="screen">
  <h2>–û—Ü–µ–Ω–∏—Ç–µ —Ä–∞–±–æ—Ç—É</h2>
  <div id="rating"></div>
</div>

<!-- STEP 3 -->
<div id="step3" class="screen">
  <h2>–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ</h2>
  <textarea id="comment" placeholder="–í–∞—à –æ—Ç–∑—ã–≤"></textarea>
  <button onclick="send()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
</div>

<!-- THANK YOU -->
<div id="thanks" class="screen">
  <h2>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –æ—Ç–∑—ã–≤ üôè</h2>
</div>

<script>
/* ==========================
   CONFIG
========================== */
const SCRIPT_URL =
  "https://script.google.com/macros/s/AKfycbzDLkPTd4Etrgj1a7odkFgJa-cN8pS4vsBfof9nTih6bGlvIGHZmosmDKIEg_xYKhSW/exec";

/* ==========================
   STATE
========================== */
let employee = "";
let score = 0;

/* ==========================
   UI HELPERS
========================== */
function show(id) {
  document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* ==========================
   STEP HANDLERS
========================== */
function selectEmployee(name) {
  employee = name;
  show("step2");
}

/* build rating buttons */
const rating = document.getElementById("rating");
for (let i = 1; i <= 10; i++) {
  const btn = document.createElement("button");
  btn.textContent = i;
  btn.onclick = () => {
    score = i;
    show("step3");
  };
  rating.appendChild(btn);
}

/* ==========================
   SEND DATA
========================== */
function send() {
  const payload = {
    employee: employee,
    score: score,
    comment: document.getElementById("comment").value
  };

  fetch(SCRIPT_URL, {
    method: "POST",
    mode: "no-cors",
    body: JSON.stringify(payload)
  });

  show("thanks");

  /* reset for next customer */
  setTimeout(() => {
    location.reload();
  }, 3000);
}
</script>

</body>
</html>

